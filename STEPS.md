# Project Build Steps: Real-Time Telemetry Platform

This document provides a step-by-step guide to building the Real-Time Vehicle Telemetry Platform using Gradle.

## Step 1: Project Scaffolding & Docker Setup

First, create the main project directory and set up the `docker-compose.yml` file, which defines all the services needed.

```bash
mkdir real-time-data-pipeline
cd real-time-data-pipeline
```

### Create initial files
- `README.md` (copy content from the main project documentation)
- `STEPS.md` (this file)
- `.gitignore` (add standard Java/Gradle and Docker ignores, e.g., `/build`, `*.jar`, `/.idea`)

### Create Docker Compose file
**File:** `docker-compose.yml`  
**Content:** Define services for Zookeeper, Kafka, Redis, and placeholders for the producer and consumer applications.

## Step 2: Build the telemetry-producer Service

This Spring Boot application will generate and send data to Kafka.

### Create service directory
```bash
mkdir telemetry-producer
```

### Initialize Spring Boot Project
Use Spring Initializr to generate a Gradle project with dependencies:
- Spring Web
- Spring for Apache Kafka

### Define file structure
- `telemetry-producer/build.gradle` (generated by Spring Initializr)
- `telemetry-producer/Dockerfile` (initially empty, will add Docker instructions)
- `telemetry-producer/src/main/resources/application.yml` (configure server port and Kafka broker addresses)
- `telemetry-producer/src/main/java/com/example/telemetryproducer/TelemetryProducerApplication.java` (main class)
- `telemetry-producer/src/main/java/com/example/telemetryproducer/model/VehicleTelemetry.java` (POJO: vehicleId, speed, latitude, longitude, fuelLevel)
- `telemetry-producer/src/main/java/com/example/telemetryproducer/config/KafkaProducerConfig.java` (Kafka producer configuration)
- `telemetry-producer/src/main/java/com/example/telemetryproducer/service/TelemetryProducerService.java` (logic to generate mock telemetry and send to Kafka)

## Step 3: Build the telemetry-consumer Service

This application reads from Kafka and writes the latest vehicle status to Redis.

### Create service directory
```bash
mkdir telemetry-consumer
```

### Initialize Spring Boot Project
Use Spring Initializr with Gradle and dependencies:
- Spring Web
- Spring for Apache Kafka
- Spring Data Redis (access + driver)

### Define file structure
- `telemetry-consumer/build.gradle` (generated by Spring Initializr)
- `telemetry-consumer/Dockerfile` (initially empty, will add Docker instructions)
- `telemetry-consumer/src/main/resources/application.yml` (configure server port, Kafka, Redis connection)
- `telemetry-consumer/src/main/java/com/example/telemetryconsumer/TelemetryConsumerApplication.java` (main class)
- `telemetry-consumer/src/main/java/com/example/telemetryconsumer/model/VehicleTelemetry.java` (same POJO as producer)
- `telemetry-consumer/src/main/java/com/example/telemetryconsumer/config/KafkaConsumerConfig.java` (Kafka consumer config)
- `telemetry-consumer/src/main/java/com/example/telemetryconsumer/config/RedisConfig.java` (Redis connection and RedisTemplate)
- `telemetry-consumer/src/main/java/com/example/telemetryconsumer/service/TelemetryConsumerService.java` (@KafkaListener method to consume messages and store in Redis)

## Step 4: Finalizing Docker Configuration and Running

### Complete Dockerfiles
Fill in the Dockerfile for both producer and consumer using multi-stage builds:
- Use Gradle image to build JAR
- Copy JAR into slim OpenJDK image

### Complete docker-compose.yml
Add service definitions for producer and consumer, including:
- Build contexts
- Ports
- Environment variables (Kafka, Redis hostnames)
- `depends_on` for Kafka and Redis

### Build and Run
From the root directory:
```bash
gradle build -x test
```
```bash
docker-compose up --build
```

